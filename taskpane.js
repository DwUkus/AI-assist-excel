/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){var e,n,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function i(t,o,a,c){var i=o&&o.prototype instanceof u?o:u,l=Object.create(i.prototype);return r(l,"_invoke",function(t,r,o){var a,c,i,u=0,l=o||[],f=!1,g={p:0,n:0,v:e,a:y,f:y.bind(e,4),d:function(t,r){return a=t,c=0,i=e,g.n=r,s}};function y(t,r){for(c=t,i=r,n=0;!f&&u&&!o&&n<l.length;n++){var o,a=l[n],y=g.p,p=a[2];t>3?(o=p===r)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=y&&((o=t<2&&y<a[1])?(c=0,g.v=r,g.n=a[1]):y<p&&(o=t<3||a[0]>r||r>p)&&(a[4]=t,a[5]=r,g.n=p,c=0))}if(o||t>1)return s;throw f=!0,r}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&y(l,p),c=l,i=p;(n=c<2?e:i)||!f;){a||(c?c<3?(c>1&&(g.n=-1),y(c,i)):g.n=i:g.v=i);try{if(u=2,a){if(c||(o="next"),n=a[o]){if(!(n=n.call(a,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,c<2&&(c=0)}else 1===c&&(n=a.return)&&n.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((n=(f=g.n<0)?i:t.call(r,g))!==s)break}catch(t){a=e,c=1,i=t}finally{u=1}}return{value:n,done:f}}}(t,a,c),!0),l}var s={};function u(){}function l(){}function f(){}n=Object.getPrototypeOf;var g=[][a]?n(n([][a]())):(r(n={},a,function(){return this}),n),y=f.prototype=u.prototype=Object.create(g);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,c,"GeneratorFunction")),e.prototype=Object.create(y),e}return l.prototype=f,r(y,"constructor",f),r(f,"constructor",l),l.displayName="GeneratorFunction",r(f,c,"GeneratorFunction"),r(y),r(y,c,"Generator"),r(y,a,function(){return this}),r(y,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:p}})()}function r(e,t,n,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}r=function(e,t,n,o){function c(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(c("next",0),c("throw",1),c("return",2))},r(e,t,n,o)}function n(e,t,r,n,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(o,a){var c=e.apply(t,r);function i(e){n(c,o,a,i,s,"next",e)}function s(e){n(c,o,a,i,s,"throw",e)}i(void 0)})}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}var i=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},r=[{key:"getContext",value:(n=o(t().m(function e(){var r;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=o(t().m(function e(r){var n,o,a,c,i;return t().w(function(e){for(;;)switch(e.n){case 0:return n=r.workbook.worksheets.getActiveWorksheet(),o=r.workbook.getSelectedRange(),a=n.getUsedRange(!0),n.load("name"),o.load("address, values"),a.load("address, values"),e.n=1,r.sync();case 1:return((c=o.values).length>50||c[0].length>20)&&(c=c.slice(0,50).map(function(e){return e.slice(0,20)})),((i=a.values).length>100||i[0].length>20)&&(i=i.slice(0,100).map(function(e){return e.slice(0,20)})),e.a(2,{sheetName:n.name,address:o.address,values:c,usedRange:{address:a.address,values:i}})}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2,e.v);case 2:return e.p=2,r=e.v,console.error("Context build failed",r),e.a(2,{sheetName:"Error",address:"",values:[],error:r.message})}},e,null,[[0,2]])})),function(){return n.apply(this,arguments)})}],r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(s(e)+" is not iterable")}function l(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var s=n&&n.prototype instanceof i?n:i,u=Object.create(s.prototype);return f(u,"_invoke",function(r,n,o){var a,i,s,u=0,l=o||[],f=!1,g={p:0,n:0,v:e,a:y,f:y.bind(e,4),d:function(t,r){return a=t,i=0,s=e,g.n=r,c}};function y(r,n){for(i=r,s=n,t=0;!f&&u&&!o&&t<l.length;t++){var o,a=l[t],y=g.p,p=a[2];r>3?(o=p===n)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=y&&((o=r<2&&y<a[1])?(i=0,g.v=n,g.n=a[1]):y<p&&(o=r<3||a[0]>n||n>p)&&(a[4]=r,a[5]=n,g.n=p,i=0))}if(o||r>1)return c;throw f=!0,n}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&y(l,p),i=l,s=p;(t=i<2?e:s)||!f;){a||(i?i<3?(i>1&&(g.n=-1),y(i,s)):g.n=s:g.v=s);try{if(u=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=g.n<0)?s:r.call(n,g))!==c)break}catch(t){a=e,i=1,s=t}finally{u=1}}return{value:t,done:f}}}(r,o,a),!0),u}var c={};function i(){}function s(){}function u(){}t=Object.getPrototypeOf;var g=[][n]?t(t([][n]())):(f(t={},n,function(){return this}),t),y=u.prototype=i.prototype=Object.create(g);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,f(e,o,"GeneratorFunction")),e.prototype=Object.create(y),e}return s.prototype=u,f(y,"constructor",u),f(u,"constructor",s),s.displayName="GeneratorFunction",f(u,o,"GeneratorFunction"),f(y),f(y,o,"Generator"),f(y,n,function(){return this}),f(y,"toString",function(){return"[object Generator]"}),(l=function(){return{w:a,m:p}})()}function f(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}f=function(e,t,r,n){function a(t,r){f(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},f(e,t,r,n)}function g(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return y(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(i)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t,r,n,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}function h(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function c(e){p(a,n,o,c,i,"next",e)}function i(e){p(a,n,o,c,i,"throw",e)}c(void 0)})}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var m,b,E,T=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"getRange",value:function(e,t,r){if(t.includes("!")){var n=t.split("!"),o=n[0].replace(/'/g,""),a=n[1];return e.workbook.worksheets.getItem(o).getRange(a)}return r.getRange(t)}},{key:"execute",value:(r=h(l().m(function e(t){var r,n,o,a,c=this;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=0,n=[],o=[],0!==t.length){e.n=1;break}return e.a(2,{success:!0,executed:0,errors:[]});case 1:return e.p=1,e.n=2,Excel.run(function(){var e=h(l().m(function e(a){var i,s,f,y,p,h;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(i=a.workbook.worksheets.getActiveWorksheet(),1!==t.length||"UNDO"!==t[0].type){e.n=3;break}if(!(s=c.undoStack.pop())){e.n=2;break}return e.n=1,c.execute(s);case 1:return e.a(2,e.v);case 2:throw new Error("Nothing to undo");case 3:f=g(t),e.p=4,p=l().m(function e(){var t,s,u,f,g,p,h,d,v,m,b,E,T,w,S,O,k,R,_,C,x,A,j,L,P,D,F,N,I;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:t=y.value,e.p=1,N=t.type,e.n="SET_VALUE"===N?2:"SET_FORMULA"===N?5:"FORMAT_BOLD"===N?8:"FORMAT_COLOR"===N?11:"FORMAT_FILL"===N?14:"CLEAR"===N?15:"CREATE_SHEET"===N?16:"COPY"===N?17:"COPY_ROW"===N?18:"INSERT_ROWS"===N?19:"DELETE_ROWS"===N?20:"INSERT_COLUMNS"===N?21:"DELETE_COLUMNS"===N?22:"CREATE_CHART"===N?23:"SORT"===N?24:"RENAME_SHEET"===N?25:"DELETE_SHEET"===N?30:"DELETE_CHART"===N?31:"DELETE_ALL_CHARTS"===N?34:"ACTIVATE_SHEET"===N?36:"SELECT"===N?37:38;break;case 2:if(!(t.args.length>=2)){e.n=4;break}return(s=c.getRange(a,t.args[0],i)).load("values"),e.n=3,a.sync();case 3:o.unshift({type:"SET_VALUE",args:[t.args[0],s.values[0][0]],original:"SET_VALUE|".concat(t.args[0],"|").concat(s.values[0][0])}),s.values=[[t.args[1]]],r++;case 4:return e.a(3,39);case 5:if(!(t.args.length>=2)){e.n=7;break}return(u=c.getRange(a,t.args[0],i)).load("formulas"),e.n=6,a.sync();case 6:f=u.formulas[0][0],o.unshift({type:"SET_FORMULA",args:[t.args[0],f],original:"SET_FORMULA|".concat(t.args[0],"|").concat(f)}),u.formulas=[[t.args[1]]],r++;case 7:return e.a(3,39);case 8:if(!(t.args.length>=2)){e.n=10;break}return(g=c.getRange(a,t.args[0],i)).load("format/font/bold"),e.n=9,a.sync();case 9:p=g.format.font.bold,o.unshift({type:"FORMAT_BOLD",args:[t.args[0],p?"true":"false"],original:"FORMAT_BOLD|".concat(t.args[0],"|").concat(p)}),h="true"===t.args[1].toLowerCase(),g.format.font.bold=h,r++;case 10:return e.a(3,39);case 11:if(!(t.args.length>=2)){e.n=13;break}return(d=c.getRange(a,t.args[0],i)).load("format/fill/color"),e.n=12,a.sync();case 12:v=d.format.fill.color,o.unshift({type:"FORMAT_COLOR",args:[t.args[0],v],original:"FORMAT_COLOR|".concat(t.args[0],"|").concat(v)}),d.format.fill.color=t.args[1],r++;case 13:return e.a(3,39);case 14:return t.args.length>=2&&(c.getRange(a,t.args[0],i).format.fill.color=t.args[1],r++),e.a(3,39);case 15:return t.args.length>=1&&(c.getRange(a,t.args[0],i).clear(),r++),e.a(3,39);case 16:if(t.args.length>=1){try{a.workbook.worksheets.add(t.args[0]),o.unshift({type:"DELETE_SHEET",args:[t.args[0]],original:"DELETE_SHEET|".concat(t.args[0])})}catch(e){"ItemAlreadyExists"!==e.code&&n.push("Could not create sheet ".concat(t.args[0],": ").concat(e.message))}r++}return e.a(3,39);case 17:return t.args.length>=2&&(m=c.getRange(a,t.args[0],i),c.getRange(a,t.args[1],i).copyFrom(m,Excel.RangeCopyType.all),o.unshift({type:"SET_VALUE",args:[t.args[1],""],original:"Cleaning copy target ".concat(t.args[1])}),r++),e.a(3,39);case 18:return t.args.length>=2&&(b=i.getRange("".concat(t.args[0],":").concat(t.args[0])),i.getRange("".concat(t.args[1],":").concat(t.args[1])).copyFrom(b,Excel.RangeCopyType.all),r++),e.a(3,39);case 19:return t.args.length>=1&&(i.getRange(t.args[0]).insert(Excel.InsertShiftDirection.down),o.unshift({type:"DELETE_ROWS",args:[t.args[0]],original:"DELETE_ROWS|".concat(t.args[0])}),r++),e.a(3,39);case 20:return t.args.length>=1&&(i.getRange(t.args[0]).delete(Excel.DeleteShiftDirection.up),r++),e.a(3,39);case 21:return t.args.length>=1&&(i.getRange(t.args[0]).insert(Excel.InsertShiftDirection.right),r++),e.a(3,39);case 22:return t.args.length>=1&&(i.getRange(t.args[0]).delete(Excel.DeleteShiftDirection.left),r++),e.a(3,39);case 23:return t.args.length>=2&&(E=t.args[0],T=c.getRange(a,t.args[1],i),w=i.charts.add(E,T,"Auto"),S=t.args[2]||"Chart",t.args[2]&&(w.title.text=t.args[2]),o.unshift({type:"DELETE_CHART",args:[S],original:"DELETE_CHART|".concat(S)}),r++),e.a(3,39);case 24:return t.args.length>=2&&(O=c.getRange(a,t.args[0],i),k=parseInt(t.args[1],10)||0,R="false"!==t.args[2],_=[{key:k,ascending:R}],O.sort.apply(_,!1),r++),e.a(3,39);case 25:if(1!==t.args.length){e.n=27;break}return i.load("name"),e.n=26,a.sync();case 26:C=i.name,o.unshift({type:"RENAME_SHEET",args:[t.args[0],C],original:"RENAME_SHEET|".concat(t.args[0],"|").concat(C)}),i.name=t.args[0],r++,e.n=29;break;case 27:if(2!==t.args.length){e.n=29;break}return(x=a.workbook.worksheets.getItem(t.args[0])).load("name"),e.n=28,a.sync();case 28:A=x.name,o.unshift({type:"RENAME_SHEET",args:[t.args[1],A],original:"RENAME_SHEET|".concat(t.args[1],"|").concat(A)}),x.name=t.args[1],r++;case 29:return e.a(3,39);case 30:return t.args.length>=1&&(a.workbook.worksheets.getItem(t.args[0]).delete(),r++),e.a(3,39);case 31:if(!(t.args.length>=1)){e.n=33;break}return(j=i.charts).load("items/title/text, items/name"),e.n=32,a.sync();case 32:if(L=t.args[0].toLowerCase(),P=j.items.find(function(e){return e.name.toLowerCase()===L||e.title&&e.title.text&&e.title.text.toLowerCase().includes(L)}))P.delete(),r++;else try{j.getItem(t.args[0]).delete(),r++}catch(e){n.push("Chart not found: ".concat(t.args[0]))}case 33:return e.a(3,39);case 34:return(D=i.charts).load("items"),e.n=35,a.sync();case 35:for(F=D.items.length-1;F>=0;F--)D.items[F].delete();return r++,e.a(3,39);case 36:return t.args.length>=1&&(a.workbook.worksheets.getItem(t.args[0]).activate(),r++),e.a(3,39);case 37:return t.args.length>=1&&(c.getRange(a,t.args[0],i).select(),r++),e.a(3,39);case 38:n.push("Unknown command: ".concat(t.type));case 39:e.n=41;break;case 40:e.p=40,I=e.v,n.push("Error executing ".concat(t.type,": ").concat(I.message));case 41:return e.a(2)}},e,null,[[1,40]])}),f.s();case 5:if((y=f.n()).done){e.n=7;break}return e.d(u(p()),6);case 6:e.n=5;break;case 7:e.n=9;break;case 8:e.p=8,h=e.v,f.e(h);case 9:return e.p=9,f.f(),e.f(9);case 10:return e.n=11,a.sync();case 11:return e.a(2)}},e,null,[[4,8,9,10]])}));return function(t){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:return e.p=3,a=e.v,e.a(2,{success:!1,executed:r,errors:[].concat(n,["Global Context Error: ".concat(a.message)])});case 4:return o.length>0&&(this.undoStack.push(o),this.undoStack.length>20&&this.undoStack.shift()),e.a(2,{success:0===n.length,executed:r,errors:n})}},e,this,[[1,3]])})),function(e){return r.apply(this,arguments)})}],t&&d(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function w(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var s=n&&n.prototype instanceof i?n:i,u=Object.create(s.prototype);return S(u,"_invoke",function(r,n,o){var a,i,s,u=0,l=o||[],f=!1,g={p:0,n:0,v:e,a:y,f:y.bind(e,4),d:function(t,r){return a=t,i=0,s=e,g.n=r,c}};function y(r,n){for(i=r,s=n,t=0;!f&&u&&!o&&t<l.length;t++){var o,a=l[t],y=g.p,p=a[2];r>3?(o=p===n)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=y&&((o=r<2&&y<a[1])?(i=0,g.v=n,g.n=a[1]):y<p&&(o=r<3||a[0]>n||n>p)&&(a[4]=r,a[5]=n,g.n=p,i=0))}if(o||r>1)return c;throw f=!0,n}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&y(l,p),i=l,s=p;(t=i<2?e:s)||!f;){a||(i?i<3?(i>1&&(g.n=-1),y(i,s)):g.n=s:g.v=s);try{if(u=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(f=g.n<0)?s:r.call(n,g))!==c)break}catch(t){a=e,i=1,s=t}finally{u=1}}return{value:t,done:f}}}(r,o,a),!0),u}var c={};function i(){}function s(){}function u(){}t=Object.getPrototypeOf;var l=[][n]?t(t([][n]())):(S(t={},n,function(){return this}),t),f=u.prototype=i.prototype=Object.create(l);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,S(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return s.prototype=u,S(f,"constructor",u),S(u,"constructor",s),s.displayName="GeneratorFunction",S(u,o,"GeneratorFunction"),S(f),S(f,o,"Generator"),S(f,n,function(){return this}),S(f,"toString",function(){return"[object Generator]"}),(w=function(){return{w:a,m:g}})()}function S(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}S=function(e,t,r,n){function a(t,r){S(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},S(e,t,r,n)}function O(e,t,r,n,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}function k(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function c(e){O(a,n,o,c,i,"next",e)}function i(e){O(a,n,o,c,i,"throw",e)}c(void 0)})}}function R(){return _.apply(this,arguments)}function _(){return _=k(w().m(function e(){var t,r;return w().w(function(e){for(;;)switch(e.n){case 0:t=document.getElementById("status-message");try{t&&(t.textContent="Открытие..."),r=new URL("dialog.html",window.location.href).toString(),Office.context.ui.displayDialogAsync(r,{height:60,width:45,displayInIframe:!1},function(e){if(e.status===Office.AsyncResultStatus.Failed)console.error("Dialog failed:",e.error.message),t&&(t.textContent="Ошибка: "+e.error.message);else{var r=e.value;console.log("Dialog opened successfully"),t&&(t.textContent="Готово. Диалог открыт."),r.addEventHandler(Office.EventType.DialogMessageReceived,function(){var e=k(w().m(function e(t){var n,o,a,c,s,u;return w().w(function(e){for(;;)switch(e.p=e.n){case 0:console.log("Message from dialog:",t.message),n={};try{n=JSON.parse(t.message)}catch(e){n={type:t.message}}if(e.p=1,"EXECUTE"!==n.type){e.n=3;break}return e.n=2,T.execute(n.commands);case 2:o=e.v,a=JSON.stringify({type:"EXECUTION_RESULT",data:o}),r.messageChild(a),e.n=5;break;case 3:if("GET_CONTEXT"!==n.type){e.n=5;break}return e.n=4,i.getContext();case 4:c=e.v,s=JSON.stringify({type:"CONTEXT",data:c}),r.messageChild(s);case 5:e.n=7;break;case 6:e.p=6,u=e.v,console.error("Failed to handle dialog message",u);case 7:return e.a(2)}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()),r.addEventHandler(Office.EventType.DialogEventReceived,function(e){console.log("Dialog event:",e)})}})}catch(e){console.error("Error opening dialog:",e),t&&(t.textContent="Ошибка: "+e.message)}case 1:return e.a(2)}},e)})),_.apply(this,arguments)}m=T,E=[],(b=v(b="undoStack"))in m?Object.defineProperty(m,b,{value:E,enumerable:!0,configurable:!0,writable:!0}):m[b]=E,Office.onReady(function(e){if(e.host===Office.HostType.Excel){console.log("Office Add-in loaded successfully");var t=document.getElementById("sideload-msg"),r=document.getElementById("app-body");t&&(t.style.display="none"),r&&(r.style.display="flex");var n=document.getElementById("open-assistant");n&&(n.onclick=R)}})}()}();
//# sourceMappingURL=taskpane.js.map