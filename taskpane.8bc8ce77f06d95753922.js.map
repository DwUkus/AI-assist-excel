{"version":3,"file":"taskpane.8bc8ce77f06d95753922.js","mappings":"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","sources":["webpack://ai-excel-assistant/./src/services/ContextBuilder.ts","webpack://ai-excel-assistant/./src/services/CommandExecutor.ts","webpack://ai-excel-assistant/./src/taskpane/taskpane.ts"],"sourcesContent":["/*\r\n * ContextBuilder.ts\r\n * Extracts context from Excel for the LLM\r\n */\r\n\r\n/* global Excel */\r\n\r\nexport interface ExcelContext {\r\n    sheetName: string;\r\n    address: string; // Selection address\r\n    values: any[][];  // Selection values\r\n    usedRange?: {\r\n        address: string;\r\n        values: any[][];\r\n    };\r\n    error?: string;\r\n}\r\n\r\nexport class ContextBuilder {\r\n    static async getContext(): Promise<ExcelContext> {\r\n        try {\r\n            return await Excel.run(async (context) => {\r\n                const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n                const range = context.workbook.getSelectedRange();\r\n                const usedRange = sheet.getUsedRange(true); // true = values only\r\n\r\n                sheet.load(\"name\");\r\n                range.load(\"address, values\");\r\n                usedRange.load(\"address, values\");\r\n\r\n                await context.sync();\r\n\r\n                // Process Selection\r\n                let selValues = range.values;\r\n                if (selValues.length > 50 || selValues[0].length > 20) {\r\n                    selValues = selValues.slice(0, 50).map(row => row.slice(0, 20));\r\n                }\r\n\r\n                // Process UsedRange (Brief overview)\r\n                let urValues = usedRange.values;\r\n                if (urValues.length > 100 || urValues[0].length > 20) {\r\n                    urValues = urValues.slice(0, 100).map(row => row.slice(0, 20));\r\n                }\r\n\r\n                return {\r\n                    sheetName: sheet.name,\r\n                    address: range.address,\r\n                    values: selValues,\r\n                    usedRange: {\r\n                        address: usedRange.address,\r\n                        values: urValues\r\n                    }\r\n                };\r\n            });\r\n        } catch (error) {\r\n            console.error(\"Context build failed\", error);\r\n            return {\r\n                sheetName: \"Error\",\r\n                address: \"\",\r\n                values: [],\r\n                error: (error as Error).message\r\n            };\r\n        }\r\n    }\r\n}\r\n","/*\r\n * CommandExecutor.ts\r\n * Executes filtered commands in Excel\r\n */\r\n\r\n/* global Excel, Office */\r\n\r\nimport { Command } from \"./CommandParser\";\r\n\r\nexport interface ExecutionResult {\r\n    success: boolean;\r\n    executed: number;\r\n    errors: string[];\r\n}\r\n\r\nexport class CommandExecutor {\r\n    private static undoStack: Command[][] = [];\r\n\r\n    private static getRange(context: Excel.RequestContext, address: string, activeSheet: Excel.Worksheet): Excel.Range {\r\n        if (address.includes(\"!\")) {\r\n            const parts = address.split(\"!\");\r\n            const sheetName = parts[0].replace(/'/g, \"\"); // Remove quotes if present\r\n            const cellAddr = parts[1];\r\n            return context.workbook.worksheets.getItem(sheetName).getRange(cellAddr);\r\n        }\r\n        return activeSheet.getRange(address);\r\n    }\r\n\r\n    static async execute(commands: Command[]): Promise<ExecutionResult> {\r\n        let executedCount = 0;\r\n        const errors: string[] = [];\r\n        const inverseCommands: Command[] = [];\r\n\r\n        if (commands.length === 0) return { success: true, executed: 0, errors: [] };\r\n\r\n        try {\r\n            await Excel.run(async (context) => {\r\n                const sheet = context.workbook.worksheets.getActiveWorksheet();\r\n                \r\n                // Special case: UNDO\r\n                if (commands.length === 1 && commands[0].type === \"UNDO\") {\r\n                    const lastActions = this.undoStack.pop();\r\n                    if (lastActions) {\r\n                        return await this.execute(lastActions); // Execute the inverse\r\n                    } else {\r\n                        throw new Error(\"Nothing to undo\");\r\n                    }\r\n                }\r\n\r\n                for (const cmd of commands) {\r\n                    try {\r\n                        switch (cmd.type) {\r\n                            case \"SET_VALUE\":\r\n                                // SET_VALUE|Address|Value\r\n                                if (cmd.args.length >= 2) {\r\n                                    const range = this.getRange(context, cmd.args[0], sheet);\r\n                                    range.load(\"values\");\r\n                                    await context.sync();\r\n                                    \r\n                                    // Capture inverse\r\n                                    inverseCommands.unshift({ \r\n                                        type: \"SET_VALUE\", \r\n                                        args: [cmd.args[0], range.values[0][0]],\r\n                                        original: `SET_VALUE|${cmd.args[0]}|${range.values[0][0]}`\r\n                                    });\r\n\r\n                                    range.values = [[cmd.args[1]]];\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n                            \r\n                            case \"SET_FORMULA\":\r\n                                // SET_FORMULA|Address|Formula\r\n                                if (cmd.args.length >= 2) {\r\n                                    const range = this.getRange(context, cmd.args[0], sheet);\r\n                                    range.load(\"formulas\");\r\n                                    await context.sync();\r\n\r\n                                    const originalFormula = range.formulas[0][0];\r\n                                    inverseCommands.unshift({\r\n                                        type: \"SET_FORMULA\",\r\n                                        args: [cmd.args[0], originalFormula],\r\n                                        original: `SET_FORMULA|${cmd.args[0]}|${originalFormula}`\r\n                                    });\r\n\r\n                                    range.formulas = [[cmd.args[1]]];\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n                                \r\n                            case \"FORMAT_BOLD\":\r\n                                // FORMAT_BOLD|Address|true/false\r\n                                if (cmd.args.length >= 2) {\r\n                                    const range = this.getRange(context, cmd.args[0], sheet);\r\n                                    range.load(\"format/font/bold\");\r\n                                    await context.sync();\r\n\r\n                                    const originalBold = range.format.font.bold;\r\n                                    inverseCommands.unshift({\r\n                                        type: \"FORMAT_BOLD\",\r\n                                        args: [cmd.args[0], originalBold ? \"true\" : \"false\"],\r\n                                        original: `FORMAT_BOLD|${cmd.args[0]}|${originalBold}`\r\n                                    });\r\n\r\n                                    const isBold = cmd.args[1].toLowerCase() === \"true\";\r\n                                    range.format.font.bold = isBold;\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n                            \r\n                            case \"FORMAT_COLOR\":\r\n                                // FORMAT_COLOR|Address|Color\r\n                                if (cmd.args.length >= 2) {\r\n                                    const range = this.getRange(context, cmd.args[0], sheet);\r\n                                    range.load(\"format/fill/color\");\r\n                                    await context.sync();\r\n\r\n                                    const originalColor = range.format.fill.color;\r\n                                    inverseCommands.unshift({\r\n                                        type: \"FORMAT_COLOR\",\r\n                                        args: [cmd.args[0], originalColor],\r\n                                        original: `FORMAT_COLOR|${cmd.args[0]}|${originalColor}`\r\n                                    });\r\n\r\n                                    range.format.fill.color = cmd.args[1];\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"FORMAT_FILL\":\r\n                                // FORMAT_FILL|Address|Color\r\n                                if (cmd.args.length >= 2) {\r\n                                    const range = this.getRange(context, cmd.args[0], sheet);\r\n                                    range.format.fill.color = cmd.args[1];\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n                            \r\n                            case \"CLEAR\":\r\n                                // CLEAR|Address\r\n                                if (cmd.args.length >= 1) {\r\n                                    const range = this.getRange(context, cmd.args[0], sheet);\r\n                                    range.clear();\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"CREATE_SHEET\":\r\n                                // CREATE_SHEET|Name\r\n                                if (cmd.args.length >= 1) {\r\n                                    try {\r\n                                        context.workbook.worksheets.add(cmd.args[0]);\r\n                                        // Capture inverse: Delete the created sheet\r\n                                        inverseCommands.unshift({\r\n                                            type: \"DELETE_SHEET\",\r\n                                            args: [cmd.args[0]],\r\n                                            original: `DELETE_SHEET|${cmd.args[0]}`\r\n                                        });\r\n                                    } catch (e) {\r\n                                        // If sheet exists, ignore error and proceed\r\n                                        // We don't add a DELETE inverse because we didn't create it\r\n                                        if ((e as any).code !== \"ItemAlreadyExists\") {\r\n                                            errors.push(`Could not create sheet ${cmd.args[0]}: ${(e as Error).message}`);\r\n                                        }\r\n                                    }\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"COPY\":\r\n                                // COPY|SourceAddress|TargetAddress\r\n                                if (cmd.args.length >= 2) {\r\n                                    const sourceRange = this.getRange(context, cmd.args[0], sheet);\r\n                                    const targetRange = this.getRange(context, cmd.args[1], sheet);\r\n                                    \r\n                                    // Copy functionality\r\n                                    targetRange.copyFrom(sourceRange, Excel.RangeCopyType.all);\r\n                                    \r\n                                    // Inverse: It's hard to perfectly undo a copy (overwrite), \r\n                                    // but we can try to clear the target.\r\n                                    // For now, simpler to not perfectly undo or just warn.\r\n                                    // A partial undo would be clearing the target range.\r\n                                    inverseCommands.unshift({\r\n                                        type: \"SET_VALUE\", // Fallback to clearing? Or just leave it.\r\n                                        // Let's rely on standard UNDO warning for structural complex changes.\r\n                                        args: [cmd.args[1], \"\"], // This is weak. Better to store state? \r\n                                        // Storing state of target range for COPY is expensive (could be massive).\r\n                                        // Let's capture the Target Range values first?\r\n                                        original: `Cleaning copy target ${cmd.args[1]}` \r\n                                    });\r\n                                    // Let's actually capture target values if small? \r\n                                    // For safety, let's just mark it executed. Undo support for Copy is Phase 10+, maybe deferred.\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"COPY_ROW\":\r\n                                // COPY_ROW|SourceRowIndex|TargetRowIndex\r\n                                if (cmd.args.length >= 2) {\r\n                                    const sourceRange = sheet.getRange(`${cmd.args[0]}:${cmd.args[0]}`);\r\n                                    const targetRange = sheet.getRange(`${cmd.args[1]}:${cmd.args[1]}`);\r\n                                    targetRange.copyFrom(sourceRange, Excel.RangeCopyType.all);\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"INSERT_ROWS\":\r\n                                // INSERT_ROWS|Address (e.g. 5:5 or A5:F5)\r\n                                if (cmd.args.length >= 1) {\r\n                                    const range = sheet.getRange(cmd.args[0]);\r\n                                    range.insert(Excel.InsertShiftDirection.down);\r\n                                    \r\n                                    // Inverse: Delete the inserted range\r\n                                    inverseCommands.unshift({\r\n                                        type: \"DELETE_ROWS\",\r\n                                        args: [cmd.args[0]],\r\n                                        original: `DELETE_ROWS|${cmd.args[0]}`\r\n                                    });\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"DELETE_ROWS\":\r\n                                // DELETE_ROWS|Address (e.g. 2:5)\r\n                                if (cmd.args.length >= 1) {\r\n                                    const range = sheet.getRange(cmd.args[0]);\r\n                                    range.delete(Excel.DeleteShiftDirection.up);\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"INSERT_COLUMNS\":\r\n                                // INSERT_COLUMNS|Address (e.g. B:B)\r\n                                if (cmd.args.length >= 1) {\r\n                                    const range = sheet.getRange(cmd.args[0]);\r\n                                    range.insert(Excel.InsertShiftDirection.right);\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"DELETE_COLUMNS\":\r\n                                // DELETE_COLUMNS|Address (e.g. A:B)\r\n                                if (cmd.args.length >= 1) {\r\n                                    const range = sheet.getRange(cmd.args[0]);\r\n                                    range.delete(Excel.DeleteShiftDirection.left);\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"CREATE_CHART\":\r\n                                // CREATE_CHART|Type|Range|Title\r\n                                // Types: ColumnClustered, Line, Pie, etc.\r\n                                if (cmd.args.length >= 2) {\r\n                                    const type = cmd.args[0] as Excel.ChartType; \r\n                                    const range = this.getRange(context, cmd.args[1], sheet);\r\n                                    const chart = sheet.charts.add(type, range, \"Auto\");\r\n                                    const title = cmd.args[2] || \"Chart\"; // Default title if not provided\r\n                                    if (cmd.args[2]) {\r\n                                        chart.title.text = cmd.args[2];\r\n                                    }\r\n                                    inverseCommands.unshift({\r\n                                        type: \"DELETE_CHART\",\r\n                                        args: [title],\r\n                                        original: `DELETE_CHART|${title}`\r\n                                    });\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n                            \r\n                            case \"SORT\":\r\n                                // SORT|Range|KeyIndex|Ascending(true/false)\r\n                                if (cmd.args.length >= 2) {\r\n                                    const range = this.getRange(context, cmd.args[0], sheet);\r\n                                    const keyIndex = parseInt(cmd.args[1], 10) || 0; // relative column index (0-based)\r\n                                    const ascending = cmd.args[2] !== \"false\"; // default true\r\n                                    \r\n                                    const sortFields = [{\r\n                                        key: keyIndex,\r\n                                        ascending: ascending\r\n                                    }];\r\n                                    \r\n                                    range.sort.apply(sortFields, false); // MatchCase=false\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"RENAME_SHEET\":\r\n                                // RENAME_SHEET|NewName (active) OR RENAME_SHEET|OldName|NewName\r\n                                if (cmd.args.length === 1) {\r\n                                    sheet.load(\"name\");\r\n                                    await context.sync();\r\n                                    const oldName = sheet.name;\r\n                                    \r\n                                    inverseCommands.unshift({\r\n                                        type: \"RENAME_SHEET\",\r\n                                        args: [cmd.args[0], oldName], // args: [newName, oldName] for inverse\r\n                                        original: `RENAME_SHEET|${cmd.args[0]}|${oldName}`\r\n                                    });\r\n                                    sheet.name = cmd.args[0];\r\n                                    executedCount++;\r\n                                } else if (cmd.args.length === 2) {\r\n                                    const targetSheet = context.workbook.worksheets.getItem(cmd.args[0]);\r\n                                    targetSheet.load(\"name\");\r\n                                    await context.sync();\r\n                                    const oldName = targetSheet.name;\r\n\r\n                                    inverseCommands.unshift({\r\n                                        type: \"RENAME_SHEET\",\r\n                                        args: [cmd.args[1], oldName], // args: [newName, oldName] for inverse\r\n                                        original: `RENAME_SHEET|${cmd.args[1]}|${oldName}`\r\n                                    });\r\n                                    targetSheet.name = cmd.args[1];\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"DELETE_SHEET\":\r\n                                // DELETE_SHEET|Name\r\n                                if (cmd.args.length >= 1) {\r\n                                    const targetSheet = context.workbook.worksheets.getItem(cmd.args[0]);\r\n                                    targetSheet.delete();\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"DELETE_CHART\":\r\n                                // DELETE_CHART|Chart Title or Name\r\n                                if (cmd.args.length >= 1) {\r\n                                    const charts = sheet.charts;\r\n                                    charts.load(\"items/title/text, items/name\");\r\n                                    await context.sync();\r\n                                    \r\n                                    const searchTerm = cmd.args[0].toLowerCase();\r\n                                    // Try exact name or fuzzy title match\r\n                                    const target = charts.items.find(c => \r\n                                        c.name.toLowerCase() === searchTerm || \r\n                                        (c.title && c.title.text && c.title.text.toLowerCase().includes(searchTerm))\r\n                                    );\r\n\r\n                                    if (target) {\r\n                                        target.delete();\r\n                                        executedCount++;\r\n                                    } else {\r\n                                        // Fallback to trying to get by name directly if search failed\r\n                                        try {\r\n                                            const item = charts.getItem(cmd.args[0]);\r\n                                            item.delete();\r\n                                            executedCount++;\r\n                                        } catch (e) {\r\n                                            errors.push(`Chart not found: ${cmd.args[0]}`);\r\n                                        }\r\n                                    }\r\n                                }\r\n                                break;\r\n\r\n                            case \"DELETE_ALL_CHARTS\":\r\n                                // DELETE_ALL_CHARTS\r\n                                // Note: deleting in loop requires care. We'll load items first.\r\n                                const charts = sheet.charts;\r\n                                charts.load(\"items\");\r\n                                await context.sync();\r\n                                for (let i = charts.items.length - 1; i >= 0; i--) {\r\n                                    charts.items[i].delete();\r\n                                }\r\n                                executedCount++;\r\n                                break;\r\n\r\n                            case \"ACTIVATE_SHEET\":\r\n                                // ACTIVATE_SHEET|Name\r\n                                if (cmd.args.length >= 1) {\r\n                                    const targetSheet = context.workbook.worksheets.getItem(cmd.args[0]);\r\n                                    targetSheet.activate();\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            case \"SELECT\":\r\n                                // SELECT|Address\r\n                                if (cmd.args.length >= 1) {\r\n                                    const target = this.getRange(context, cmd.args[0], sheet);\r\n                                    target.select();\r\n                                    executedCount++;\r\n                                }\r\n                                break;\r\n\r\n                            default:\r\n                                errors.push(`Unknown command: ${cmd.type}`);\r\n                        }\r\n                    } catch (e) {\r\n                        errors.push(`Error executing ${cmd.type}: ${(e as Error).message}`);\r\n                    }\r\n                }\r\n                \r\n                await context.sync();\r\n            });\r\n        } catch (globalError) {\r\n             return { \r\n                 success: false, \r\n                 executed: executedCount, \r\n                 errors: [...errors, `Global Context Error: ${(globalError as Error).message}`] \r\n             };\r\n        }\r\n\r\n        // Save to Undo Stack if successful and not an UNDO command itself\r\n        if (inverseCommands.length > 0) {\r\n            this.undoStack.push(inverseCommands);\r\n            if (this.undoStack.length > 20) this.undoStack.shift();\r\n        }\r\n\r\n        return {\r\n            success: errors.length === 0,\r\n            executed: executedCount,\r\n            errors: errors\r\n        };\r\n    }\r\n}\r\n","/*\r\n * AI   Excel\r\n * Taskpane entry point\r\n */\r\n\r\n/* global document, Office */\r\n\r\nimport \"./taskpane.css\";\r\nimport { ContextBuilder } from \"../services/ContextBuilder\";\r\nimport { CommandExecutor } from \"../services/CommandExecutor\";\r\n\r\nOffice.onReady((info) => {\r\n  if (info.host === Office.HostType.Excel) {\r\n    console.log(\"Office Add-in loaded successfully\");\r\n\r\n    // Hide sideload message, show app body\r\n    const sideloadMsg = document.getElementById(\"sideload-msg\");\r\n    const appBody = document.getElementById(\"app-body\");\r\n\r\n    if (sideloadMsg) sideloadMsg.style.display = \"none\";\r\n    if (appBody) appBody.style.display = \"flex\";\r\n\r\n    // Setup button handler\r\n    const openButton = document.getElementById(\"open-assistant\");\r\n    if (openButton) {\r\n      openButton.onclick = openAssistantDialog;\r\n    }\r\n  }\r\n});\r\n\r\n/**\r\n * Opens the AI Assistant dialog\r\n */\r\nasync function openAssistantDialog(): Promise<void> {\r\n  const statusMessage = document.getElementById(\"status-message\");\r\n  \r\n  try {\r\n    if (statusMessage) statusMessage.textContent = \"...\";\r\n    \r\n    // Construct the URL. Use relative path to support GitHub Pages subfolder.\r\n    const url = new URL(\"dialog.html\", window.location.href).toString();\r\n    \r\n    Office.context.ui.displayDialogAsync(\r\n      url,\r\n      { height: 60, width: 45, displayInIframe: false },\r\n      (asyncResult) => {\r\n        if (asyncResult.status === Office.AsyncResultStatus.Failed) {\r\n          console.error(\"Dialog failed:\", asyncResult.error.message);\r\n          if (statusMessage) statusMessage.textContent = \": \" + asyncResult.error.message;\r\n        } else {\r\n          const dialog = asyncResult.value;\r\n          // We will use this later for message passing\r\n          console.log(\"Dialog opened successfully\");\r\n          if (statusMessage) statusMessage.textContent = \".  .\";\r\n          \r\n\r\n\r\n          dialog.addEventHandler(Office.EventType.DialogMessageReceived, async (arg: any) => {\r\n             console.log(\"Message from dialog:\", arg.message);\r\n             \r\n             let msg: any = {};\r\n             \r\n             // Try Parsing JSON\r\n             try {\r\n                 msg = JSON.parse(arg.message);\r\n             } catch (e) {\r\n                 // Not JSON, treat as string command\r\n                 msg = { type: arg.message };\r\n             }\r\n\r\n             try {\r\n                 if (msg.type === \"EXECUTE\") {\r\n                     const result = await CommandExecutor.execute(msg.commands);\r\n                     const response = JSON.stringify({ type: \"EXECUTION_RESULT\", data: result });\r\n                     // @ts-ignore\r\n                     dialog.messageChild(response);\r\n                 }\r\n                 else if (msg.type === \"GET_CONTEXT\") {\r\n                     const context = await ContextBuilder.getContext();\r\n                     const response = JSON.stringify({ type: \"CONTEXT\", data: context });\r\n                     // @ts-ignore\r\n                     dialog.messageChild(response);\r\n                 }\r\n             } catch (e) {\r\n                 console.error(\"Failed to handle dialog message\", e);\r\n             }\r\n          });\r\n          \r\n          dialog.addEventHandler(Office.EventType.DialogEventReceived, (arg) => {\r\n             console.log(\"Dialog event:\", arg);\r\n          });\r\n        }\r\n      }\r\n    );\r\n    \r\n  } catch (error) {\r\n    console.error(\"Error opening dialog:\", error);\r\n    if (statusMessage) {\r\n      statusMessage.textContent = \": \" + (error as Error).message;\r\n    }\r\n  }\r\n}\r\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperties","_toPropertyKey","key","_typeof","toPrimitive","String","_toPrimitive","ContextBuilder","_classCallCheck","_getContext","_callee2","_t","_context2","Excel","run","_ref","_callee","context","sheet","range","usedRange","selValues","urValues","_context","workbook","worksheets","getActiveWorksheet","getSelectedRange","getUsedRange","load","sync","values","slice","map","row","sheetName","name","address","_x","console","error","message","_createForOfIteratorHelper","Array","isArray","_arrayLikeToArray","toString","constructor","from","test","_unsupportedIterableToArray","_n","F","s","next","CommandExecutor","activeSheet","includes","parts","split","replace","cellAddr","getItem","getRange","_execute","commands","executedCount","errors","inverseCommands","_t4","_this","_context3","success","executed","lastActions","_iterator","_step","_loop","_t3","type","undoStack","pop","execute","Error","cmd","_range","originalFormula","_range2","originalBold","isBold","_range3","originalColor","sourceRange","_sourceRange","_range0","chart","title","_range1","keyIndex","ascending","sortFields","oldName","targetSheet","_oldName","_charts","searchTerm","target","charts","_t2","args","unshift","original","concat","formulas","format","font","bold","toLowerCase","fill","color","clear","add","code","push","copyFrom","RangeCopyType","all","insert","InsertShiftDirection","down","delete","DeleteShiftDirection","up","right","left","text","parseInt","sort","items","find","activate","select","_regeneratorValues","_x2","this","shift","openAssistantDialog","_openAssistantDialog","statusMessage","url","document","getElementById","textContent","URL","window","location","href","Office","ui","displayDialogAsync","height","width","displayInIframe","asyncResult","status","AsyncResultStatus","Failed","dialog","log","addEventHandler","EventType","DialogMessageReceived","arg","msg","result","response","_response","JSON","parse","stringify","data","messageChild","getContext","DialogEventReceived","onReady","info","host","HostType","sideloadMsg","appBody","style","display","openButton","onclick"],"ignoreList":[],"sourceRoot":""}